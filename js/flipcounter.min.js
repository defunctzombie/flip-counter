/**
 * Apple-Style Flip Counter
 * ------------------------
 *
 * Copyright (c) 2010 Chris Nanney
 * http://cnanney.com/journal/code/apple-style-counter-revisited/
 *
 * Licensed under MIT
 * http://www.opensource.org/licenses/mit-license.php
 */
var flipCounter=function(w,D){function s(){i=a.value.toString();a.value+=a.inc;h=a.value.toString();o(i,h);a.auto===!0&&(k=setTimeout(s,a.pace))}function x(c,f,b){var d=a.value,e=typeof f=="undefined"?!1:f,g=typeof b=="undefined"?1:b;e===!0&&g--;d!=c?(i=a.value.toString(),a.auto=!0,d+a.inc<=c&&g!=0?d+=a.inc:d=c,a.value=d,h=a.value.toString(),o(i,h),k=setTimeout(function(){x(c,e,g)},a.pace)):a.auto=!1}function o(c,a){var b;t=y(c);u=y(a);if(a.length>c.length)for(b=a.length-c.length;b>0;){var d=u[a.length-
b],e=Number(a.length-b+1)-1;e%3==0&&jQuery(j).prepend('<ul class="cd"><li class="s"></li></ul>');jQuery(j).prepend('<ul class="cd" id="d'+e+'"><li class="t"></li><li class="b"></li></ul>');jQuery(j+" #d"+e+" li.t").css({"background-position":"0 -"+d*p+"px"});jQuery(j+" #d"+e+" li.b").css({"background-position":"0 -"+d*n+"px"});b--}if(a.length<c.length)for(b=c.length-a.length;b>0;)jQuery(j+" #d"+(c.length-b)).remove(),d=jQuery(j+" li").first(),d.hasClass("s")&&d.parent("ul").remove(),b--;for(b=0;b<
t.length;b++)u[b]!=t[b]&&E(b,t[b],u[b])}function E(c,f,b){function d(){g<7&&(h=g<3?"t":"b",jQuery(j+" #d"+c+" li."+h).css("background-position",i[g]),g++,g!=3?setTimeout(d,e):d())}var e,g=0,h,i=["-"+q+"px -"+f*p+"px",q*-2+"px -"+f*p+"px","0 -"+b*p+"px","-"+q+"px -"+f*n+"px",q*-2+"px -"+b*n+"px",q*-3+"px -"+b*n+"px","0 -"+b*n+"px"];if(a.auto===!0&&a.pace<=300)switch(c){case 0:e=a.pace/6;break;case 1:e=a.pace/5;break;case 2:e=a.pace/4;break;case 3:e=a.pace/3;break;default:e=a.pace/1.5}else e=80;e=e>
80?80:e;d()}function y(c){for(var a=[],b=0;b<c.length;b++)A=c.length-(b+1),B=c.length-b,a[b]=c.substring(A,B);return a}function C(a,f,b,d,e){var g={result:!0};g.cond1=a/f>=1?!0:!1;g.cond2=f*b<=a?!0:!1;g.cond3=Math.abs(f*b-a)<=10?!0:!1;g.cond4=Math.abs(f*d-e)<=100?!0:!1;g.cond5=f*d<=e?!0:!1;if(g.cond1&&g.cond2&&g.cond4&&g.cond5){a=Math.abs(a-f*b)+Math.abs(f*d-e);if(l.q===null)l.q=a;if(a<=l.q)l.pace=d,l.inc=b}for(b=1;b<=5;b++)if(g["cond"+b]===!1)g.result=!1;return g}function m(a){return!isNaN(parseFloat(a))&&
isFinite(a)}function z(){clearTimeout(k);k=null}var v={value:0,inc:1,pace:1E3,auto:!0,debug:!1},a=D||{},j=w&&w!=""?"#"+w:"#counter",r;for(r in v)a[r]=r in a?a[r]:v[r];var p=39,n=64,q=53,t=[],u=[],A,B,i,h,k=null,l={q:null,pace:0,inc:0};this.setValue=function(c){if(m(c))i=a.value.toString(),h=c.toString(),a.value=c,o(i,h);return this};this.setIncrement=function(c){a.inc=m(c)?c:v.inc;return this};this.setPace=function(c){a.pace=m(c)?c:v.pace;return this};this.setAuto=function(c){if(c&&!a.atuo)a.auto=
!0,s();if(!c&&a.auto)k&&z(),a.auto=!1;return this};this.step=function(){a.auto||s();return this};this.add=function(c){m(c)&&(i=a.value.toString(),a.value+=c,h=a.value.toString(),o(i,h));return this};this.subtract=function(c){if(m(c))i=a.value.toString(),a.value-=c,a.value>=0?h=a.value.toString():(h="0",a.value=0),o(i,h);return this};this.incrementTo=function(c,f,b){k&&z();if(typeof f!="undefined"){var f=m(f)?f*1E3:1E4,b=typeof b!="undefined"&&m(b)?b:a.pace,d=typeof c!="undefined"&&m(c)?c-a.value:
0,e,g,h,i=0;l.q=null;b=f/d>b?Math.round(f/d/10)*10:b;e=Math.floor(f/b);g=Math.floor(d/e);h=C(d,e,g,b,f);if(d>0){for(;h.result===!1&&i<100;)b+=10,e=Math.floor(f/b),g=Math.floor(d/e),h=C(d,e,g,b,f),i++;i==100?(a.inc=l.inc,a.pace=l.pace):(a.inc=g,a.pace=b);x(c,!0,e)}}else x(c)};this.getValue=function(){return a.value};this.stop=function(){k&&z();return this};(function(c){var f=c.toString().length,b=1,d;for(d=0;d<f;d++)jQuery(j).prepend('<ul class="cd" id="d'+d+'"><li class="t"></li><li class="b"></li></ul>'),
b!=f&&b%3==0&&jQuery(j).prepend('<ul class="cd"><li class="s"></li></ul>'),b++;c=y(c.toString());for(d=0;d<f;d++)jQuery(j+" #d"+d+" li.t").css({"background-position":"0 -"+c[d]*p+"px"}),jQuery(j+" #d"+d+" li.b").css({"background-position":"0 -"+c[d]*n+"px"});a.auto===!0&&(k=setTimeout(s,a.pace))})(a.value)};