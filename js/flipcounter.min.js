/**
 * Apple-Style Flip Counter
 * ------------------------
 *
 * Copyright (c) 2010 Chris Nanney
 * http://cnanney.com/journal/code/apple-style-counter-revisited/
 * http://cnanney.com/journal/code/apple-style-counter/
 *
 * Licensed under MIT
 * http://www.opensource.org/licenses/mit-license.php
 */
var flipCounter=function(z,H){function t(){j=b.value.toString();b.value+=b.inc;i=b.value.toString();o(j,i);if(b.auto===true)l=setTimeout(t,b.pace)}function A(a,e,c){var d=b.value,g=typeof e=="undefined"?false:e,f=typeof c=="undefined"?1:c;g===true&&f--;if(d!=a){j=b.value.toString();b.auto=true;if(d+b.inc<=a&&f!=0)d+=b.inc;else d=a;b.value=d;i=b.value.toString();o(j,i);l=setTimeout(function(){A(a,g,f)},b.pace)}else b.auto=false}function o(a,e){u=B(a);v=B(e);if(e.length>a.length)for(var c=e.length-
a.length;c>0;){var d=v[e.length-c],g=Number(e.length-c+1)-1;g%3==0&&jQuery(h).prepend('<ul class="cd"><li class="s"></li></ul>');jQuery(h).prepend('<ul class="cd" id="d'+g+'"><li class="t"></li><li class="b"></li></ul>');jQuery(h+" #d"+g+" li.t").css({"background-position":"0 -"+d*p+"px"});jQuery(h+" #d"+g+" li.b").css({"background-position":"0 -"+d*n+"px"});c--}if(e.length<a.length)for(c=a.length-e.length;c>0;){jQuery(h+" #d"+(a.length-c)).remove();d=jQuery(h+" li").first();d.hasClass("s")&&d.parent("ul").remove();
c--}for(c=0;c<u.length;c++)v[c]!=u[c]&&I(c,u[c],v[c])}function I(a,e,c){var d;if(b.auto===true&&b.pace<=300)switch(a){case 0:d=b.pace/6;break;case 1:d=b.pace/5;break;case 2:d=b.pace/4;break;case 3:d=b.pace/3;break;default:d=b.pace/2}else d=80;d=d>80?80:d;jQuery(h+" #d"+a+" li.t").delay(d).animate({backgroundPositionX:-q,backgroundPositionY:-e*p},0).delay(d).animate({backgroundPositionX:q*-2,backgroundPositionY:-e*p},0).delay(d).animate({backgroundPositionX:0,backgroundPositionY:-c*p},0,function(){jQuery(h+
" #d"+a+" li.b").animate({backgroundPositionX:-q,backgroundPositionY:-e*n},0).delay(d).animate({backgroundPositionX:q*-2,backgroundPositionY:-c*n},0).delay(d).animate({backgroundPositionX:q*-3,backgroundPositionY:-c*n},0).delay(d).animate({backgroundPositionX:0,backgroundPositionY:-c*n},0)})}function B(a){for(var e=[],c=0;c<a.length;c++){E=a.length-(c+1);F=a.length-c;e[c]=a.substring(E,F)}return e}function G(a,e,c,d,g){var f={result:true};f.cond1=a/e>=1?true:false;f.cond2=e*c<=a?true:false;f.cond3=
Math.abs(e*c-a)<=5?true:false;f.cond4=Math.abs(e*d-g)<=100?true:false;f.cond5=e*d<=g?true:false;f.str="Condition Checks:\n";for(var k=1;k<=5;k++){f.str+=k+": ";if(f["cond"+k]===false){f.str+="FAIL";f.result=false}else f.str+="PASS";f.str+=k<5?", ":""}f.str+="\n----\n   Pace: "+d+"\n   Cycles: "+e+"\n   Calculated Inc: "+a/e+"\n   Rounded Inc: "+c+"\n   Calculated time: "+Math.abs(e*d)+"\n   Target time: "+g+"\n   ACTUAL END VALUE: "+(e*c+b.value);return f}function m(a){return!isNaN(parseFloat(a))&&
isFinite(a)}function C(){clearTimeout(l);l=null}var w={value:0,inc:1,pace:1E3,auto:true,debug:false},b=H||{},h=z&&z!=""?"#"+z:"#counter",r;for(r in w)b[r]=r in b?b[r]:w[r];var p=39,n=64,q=53,u=[],v=[],E,F,j,i,l=null;this.setValue=function(a){if(m(a)){j=b.value.toString();i=a.toString();b.value=a;o(j,i)}return this};this.setIncrement=function(a){b.inc=m(a)?a:w.inc;return this};this.setPace=function(a){b.pace=m(a)?a:w.pace;return this};this.setAuto=function(a){if(a&&!b.atuo){b.auto=true;t()}if(!a&&
b.auto){l&&C();b.auto=false}return this};this.step=function(){b.auto||t();return this};this.add=function(a){if(m(a)){j=b.value.toString();b.value+=a;i=b.value.toString();o(j,i)}return this};this.subtract=function(a){if(m(a)){j=b.value.toString();b.value-=a;if(b.value>=0)i=b.value.toString();else{i="0";b.value=0}o(j,i)}return this};this.incrementTo=function(a,e,c){l&&C();if(typeof e!="undefined"){e=m(e)?e*1E3:1E4;c=typeof c!="undefined"&&m(c)?c:b.pace;var d=typeof a!="undefined"&&m(a)?a-b.value:0,
g,f,k,D,s,x=0,y={pace:0,inc:0};c=e/d>c?Math.round(e/d/10)*10:c;g=Math.floor(e/c);f=Math.round(d/g);k=Math.abs(d-g*f)+Math.abs(g*c-e);s=G(d,g,f,c,e);b.debug&&console.log("***************************************************************\nSTART: "+b.value+"\nEND: "+a+"\n"+s.str);if(d>0){for(;s.result===false&&x<100;){c+=10;g=Math.floor(e/c);f=Math.round(d/g);D=Math.abs(d-g*f)+Math.abs(g*c-e);s=G(d,g,f,c,e);if(D<k){k=D;y.pace=c;y.inc=f}b.debug&&console.log("ADJUSTMENT: "+(x+1)+"\n"+s.str);x++}if(x==100){b.inc=
y.inc;b.pace=y.pace}else{b.inc=f;b.pace=c}A(a,true,g)}}else A(a)};this.getValue=function(){return b.value};this.stop=function(){l&&C();return this};(function(a){for(var e=a.toString().length,c=1,d=0;d<e;d++){jQuery(h).prepend('<ul class="cd" id="d'+d+'"><li class="t"></li><li class="b"></li></ul>');c!=e&&c%3==0&&jQuery(h).prepend('<ul class="cd"><li class="s"></li></ul>');c++}a=B(a.toString());for(d=0;d<e;d++){jQuery(h+" #d"+d+" li.t").css({"background-position":"0 -"+a[d]*p+"px"});jQuery(h+" #d"+
d+" li.b").css({"background-position":"0 -"+a[d]*n+"px"})}if(b.auto===true)l=setTimeout(t,b.pace)})(b.value)};